1) Вывести подходящие вакансии для соискателей
SELECT Z2.SOIS, Z2.VACAN, Z2.KOL
FROM
(SELECT A1.vacancyNAME VAC, COUNT(REQUIREMENTID) COUN
FROM REQUIR_VACAN A INNER JOIN vacanciess A1 ON A.vacancyid=a1.vacancyid
GROUP BY A1.vacancyNAME) Z1
INNER JOIN
(SELECT  A.SOISKATELNAME SOIS, a2.vacancyname VACAN, COUNT(a6.skillid) KOL
FROM SOISKATELS A INNER JOIN zayavka A1 ON A.SOISKATELID=a1.soiskatelid
INNER JOIN vacanciess A2 ON a1.vacancyid=a2.vacancyid
INNER JOIN requir_vacan A3 ON a2.vacancyid=a3.vacancyid
INNER JOIN requirements A4 ON A3.REQUIREMENTID=a4.requirementid 
INNER JOIN skills_soisk A5 ON A.SOISKATELID=a5.soiskatelid
INNER JOIN skills A6 ON a5.skillid=a6.skillid
WHERE a6.skillid =A4.requirementID
GROUP BY A.SOISKATELNAME, a2.vacancyname) Z2
ON Z1.VAC=Z2.VACAN
WHERE z2.kol>=Z1.COUN;

2) Для каждой фирмы посчитать кол-во её специализаций
SELECT FIRMAID, COUNT(SPECID)
FROM  spec_FIRM 
GROUP BY firmaid;

3) Вывести вакансию с максимальным кол-ом требований
SELECT Z3.VAC,Z3.COUN
FROM
(SELECT MAX(Z1.COUN) MAX
FROM
(SELECT VACANCYID VAC, COUNT(REQUIREMENTID) COUN
FROM REQUIR_VACAN
GROUP BY VACANCYID)Z1)Z2
INNER JOIN (SELECT VACANCYID VAC, COUNT(REQUIREMENTID) COUN
FROM REQUIR_VACAN
GROUP BY VACANCYID)Z3
ON Z2.MAX=Z3.COUN;

4) Вывести соискателей, у которых отсутствует номер тл
SELECT SOISKATELNAME
FROM SOISKATELS
WHERE TELEPHONE IS NULL;

5) Вывести вакансии с датой размещения от 24.05.2022 до 25.05.2022
SELECT A.VACANCYNAME FROM VACANCIESS A INNER JOIN OFFERS A1 ON A.VACANCYID=A1.VACANCYID
WHERE DATE_LOC BETWEEN TO_DATE('24.05.2022','DD/MM/YYYY') AND TO_DATE('25.05.2022','DD/MM/YYYY');

6) Вывести вакансии, у которых удалённый тип работы
SELECT A.VACANCYNAME
FROM VACANCIESS A INNER JOIN OFFERS A1 ON A.VACANCYID=A1.VACANCYID INNER JOIN TYPEWORK A2 ON a1.workid=a2.workid
WHERE a2.type LIKE 'WORK AT HOME';

7) Найти все вакансии, которых не было вчера(24.05.2022), но появились сегодня(25.05.2022)
SELECT Z2.VACC FROM
(SELECT A.VACANCYNAME VACC FROM VACANCIESS A INNER JOIN OFFERS A1 ON A.VACANCYID=A1.VACANCYID
WHERE DATE_LOC= TO_DATE('24.05.2022','DD/MM/YYYY'))z2
LEFT JOIN
(SELECT A.VACANCYNAME VAC FROM VACANCIESS A INNER JOIN OFFERS A1 ON A.VACANCYID=A1.VACANCYID
WHERE DATE_LOC= TO_DATE('25.05.2022','DD/MM/YYYY'))z3
ON Z2.VACC=Z3.VAC;

8) Вывести вакансии, на которою max кол-во заявок.
SELECT Z3.VAC, Z3.KOL
FROM
(SELECT  MAX(Z1.KOL) MAX 
FROM
(SELECT A.VACANCYNAME VAC, COUNT(A1.SOISKATELID) KOL
FROM VACANCIESS A INNER JOIN ZAYAVKA A1 ON A.VACANCYID=a1.vacancyid
GROUP BY a.vacancyname)Z1
)Z2
INNER JOIN 
(SELECT A.VACANCYNAME VAC, COUNT(A1.SOISKATELID) KOL
FROM VACANCIESS A INNER JOIN ZAYAVKA A1 ON A.VACANCYID=a1.vacancyid
GROUP BY a.vacancyname)Z3
ON Z2.MAX=Z3.KOL;

9) Создать представление "Соискатель и его навык" 
CREATE VIEW SOIS(SOISKATELNAME, SKILLNAME) AS
SELECT SOISKATELNAME, SKILLNAME 
FROM SOISKATELS A, skills_soisk A1, SKILLS A2
WHERE a.soiskatelid=a1.soiskatelid AND a1.skillid=a2.skillid;

10) Создать представление "Вакансия и её требование"
CREATE VIEW VAC(VACANCYNAME, REQUIREMENTNAME) AS
SELECT VACANCYNAME, REQUIREMENTNAME
FROM VACANCIESS A, requir_vacan A1, requirements A2
WHERE a.vacancyid=a1.vacancyid  AND  a1.requirementid=a2.requirementid;

SELECT VACANCYNAME,
(SELECT REQUIREMENTNAME FROM VAC TREB),
(SELECT SKILLNAME FROM SOIS)
FROM VACANCIESS
WHERE (SELECT REQUIREMENTNAME FROM VAC)=(SELECT SKILLNAME FROM SOIS);



